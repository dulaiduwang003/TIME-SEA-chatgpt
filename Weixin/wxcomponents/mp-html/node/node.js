(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["wxcomponents/mp-html/node/node"],{"5f25":function(t,e,s){"use strict";s.r(e);var i=s("9a2d"),o=s("b6b0");for(var r in o)["default"].indexOf(r)<0&&function(t){s.d(e,t,(function(){return o[t]}))}(r);s("8fbb");var a=s("f0c5"),n=s("91d6"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);"function"===typeof n["a"]&&Object(n["a"])(c),e["default"]=c.exports},"8fbb":function(t,e,s){"use strict";var i=s("9b59"),o=s.n(i);o.a},"91d6":function(t,e,s){"use strict";e["a"]=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[])}},"9a2d":function(t,e,s){"use strict";s.d(e,"b",(function(){return i})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){}));var i=function(){var t=this.$createElement;this._self._c},o=[]},"9b59":function(t,e,s){},b6b0:function(t,e,s){"use strict";s.r(e);var i=s("d56c"),o=s.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){s.d(e,t,(function(){return i[t]}))}(r);e["default"]=o.a},d56c:function(t,e,s){"use strict";(function(t,i){var o=s("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(s("69c8"));function a(t){var e;return e=t.detail.y,(e-t.currentTarget.offsetTop<150||e<600)&&(e=t.currentTarget.offsetTop),e<30&&(e+=70),e-30}var n={name:"node",options:{virtualHost:!0},data:function(){return{ctrl:{},isiOS:t.getSystemInfoSync().system.includes("iOS")}},props:{name:String,attrs:{type:Object,default:function(){return{}}},childs:Array,opts:Array},components:{myAudio:function(){s.e("wxcomponents/mp-html/audio/audio").then(function(){return resolve(s("9f0c"))}.bind(null,s)).catch(s.oe)},node:function(){Promise.resolve().then(function(){return resolve(s("5f25"))}.bind(null,s)).catch(s.oe)}},mounted:function(){var t=this;this.$nextTick((function(){for(t.root=t.$parent;"mp-html"!==t.root.$options.name;t.root=t.root.$parent);}))},beforeDestroy:function(){this.root._edit===this&&(this.root._edit=void 0)},methods:{copyCode:function(e){t.showActionSheet({itemList:["复制代码"],success:function(){return t.setClipboardData({data:e.currentTarget.dataset.content})}})},editStart:function(t){var e=this;if(this.opts[5]){var s=t.currentTarget.dataset.i;this.ctrl["e"+s]?(this.root._mask.pop(),this.root._maskTap(),this.$set(this.ctrl,"e"+s,2),setTimeout((function(){e.$set(e.ctrl,"e"+s,3)}),50)):(this.$set(this.ctrl,"e"+s,1),setTimeout((function(){e.root._mask.push((function(){return e.$set(e.ctrl,"e"+s,0)}))}),50),this.root._edit=this,this.i=s,this.cursor=this.childs[s].text.length)}},editInput:function(t){var e=t.target.dataset.i,s=t.detail.value.replace(/ {2,}/,(function(t){for(var e=" ",s=1;s<t.length;s++)e+=" ";return e}));this.root._editVal("".concat(this.opts[7],".").concat(e,".text"),this.childs[e].text,s),this.cursor=t.detail.cursor},editEnd:function(t){var e=t.target.dataset.i;this.$set(this.ctrl,"e"+e,0),this.root._setData("".concat(this.opts[7],".").concat(e,".text"),t.detail.value.replace(/ {2}/g,"  ")),void 0!==t.detail.cursor&&(this.cursor=t.detail.cursor)},insert:function(t){var e=this;setTimeout((function(){var s=e.childs.slice(0);if(s[e.i])if(s[e.i].text){var i=s[e.i].text;if("text"===t.type)e.cursor?s[e.i].text=i.substring(0,e.cursor)+t.text+i.substring(e.cursor):s[e.i].text+=t.text;else{var o=[];e.cursor&&o.push({type:"text",text:i.substring(0,e.cursor)}),o.push(t),e.cursor<i.length&&o.push({type:"text",text:i.substring(e.cursor)}),s.splice.apply(s,[e.i,1].concat(o))}}else s.splice(parseInt(e.i)+1,0,t);else s.push(t);e.root._editVal(e.opts[7],e.childs,s,!0),e.i=parseInt(e.i)+1}),200)},remove:function(t){var e=this.childs.slice(0),s=e.splice(t,1)[0];if("img"===s.name||"video"===s.name||"audio"===s.name){var i=s.attrs.src;s.src&&(i=1===s.src.length?s.src[0]:s.src),this.root.$emit("remove",{type:s.name,src:i})}this.root._edit=void 0,this.root._maskTap(),this.root._editVal(this.opts[7],this.childs,e,!0)},nodeTap:function(t){var e=this;if(this.opts[5]){if(this.root._lock)return;if(this.root._lock=!0,setTimeout((function(){e.root._lock=!1}),50),3===this.ctrl["e"+this.i])return;this.root._maskTap(),this.root._edit=this;var s=this.opts[7].lastIndexOf("children.");-1!==s?s+=9:s=6;var i=parseInt(this.opts[7].substring(s,this.opts[7].lastIndexOf(".children"))),o=this.$parent;while(o&&"node"!==o.$options.name)o=o.$parent;if(!o||this.opts[7].length-o.opts[7].length>15)return;this.$set(this.ctrl,"root",1),this.root._mask.push((function(){return e.$set(e.ctrl,"root",0)})),1!==this.childs.length||"text"!==this.childs[0].type||this.ctrl.e0||(this.$set(this.ctrl,"e0",1),this.root._mask.push((function(){return e.$set(e.ctrl,"e0",0)})),this.i=0,this.cursor=this.childs[0].text.length);var r=this.root._getItem(o.childs[i],0!==i,i!==o.childs.length-1);this.root._tooltip({top:a(t),items:r,success:function(s){if("大小"===r[s]){var n=o.childs[i].attrs.style||"",c=n.match(/;font-size:([0-9]+)px/);c=c?parseInt(c[1]):16,e.root._slider({min:10,max:30,value:c,top:a(t),changing:function(e){Math.abs(e-c)>2&&(o.changeStyle("font-size",i,e+"px",c+"px"),c=t.detail.value)},change:function(t){t!==c&&o.changeStyle("font-size",i,t+"px",c+"px"),e.root._editVal("".concat(o.opts[7],".").concat(i,".attrs.style"),n,o.childs[i].attrs.style)}})}else if("颜色"===r[s]){var h=e.root._getItem("color");e.root._color({top:a(t),items:h,success:function(t){var s=o.childs[i].attrs.style||"",r=s.match(/;color:([^;]+)/);o.changeStyle("color",i,h[t],r?r[1]:void 0),e.root._editVal("".concat(o.opts[7],".").concat(i,".attrs.style"),s,o.childs[i].attrs.style)}})}else if("上移"===r[s]||"下移"===r[s]){var l=o.childs.slice(0),u=l[i];"上移"===r[s]?(l[i]=l[i-1],l[i-1]=u):(l[i]=l[i+1],l[i+1]=u),e.root._editVal(o.opts[7],o.childs,l,!0)}else if("删除"===r[s])o.remove(i);else{var d,f,p=o.childs[i].attrs.style||"",g="",m=r[s];"斜体"===m?(d="font-style",f="italic"):"粗体"===m?(d="font-weight",f="bold"):"下划线"===m?(d="text-decoration",f="underline"):"居中"===m?(d="text-align",f="center"):"缩进"===m&&(d="text-indent",f="2em"),g=p.includes(d+":")?p.replace(new RegExp(d+":[^;]+"),""):p+";"+d+":"+f,e.root._editVal("".concat(o.opts[7],".").concat(i,".attrs.style"),p,g,!0)}}})}},mediaTap:function(e){var s=this;if(this.opts[5]){var i=e.target.dataset.i,o=this.childs[i],r=this.root._getItem(o);this.root._maskTap(),this.root._edit=this,this.i=i,this.root._tooltip({top:e.target.offsetTop-30,items:r,success:function(e){switch(r[e]){case"封面":s.root.getSrc("img",o.attrs.poster||"").then((function(t){s.root._editVal("".concat(s.opts[7],".").concat(i,".attrs.poster"),o.attrs.poster,t instanceof Array?t[0]:t,!0)})).catch((function(){}));break;case"删除":s.remove(i);break;case"循环":case"不循环":s.root._setData("".concat(s.opts[7],".").concat(i,".attrs.loop"),!o.attrs.loop),t.showToast({title:"成功"});break;case"自动播放":case"不自动播放":s.root._setData("".concat(s.opts[7],".").concat(i,".attrs.autoplay"),!o.attrs.autoplay),t.showToast({title:"成功"});break}}}),this.root._lock=!0,setTimeout((function(){s.root._lock=!1}),50)}},changeStyle:function(t,e,s,i){var o=this.childs[e].attrs.style||"";o.includes(";"+t+":"+i)?o=o.replace(";"+t+":"+i,";"+t+":"+s):o+=";"+t+":"+s,this.root._setData("".concat(this.opts[7],".").concat(e,".attrs.style"),o)},toJSON:function(){return this},play:function(e){if(this.root.$emit("play"),this.root.pauseVideo){for(var s=!1,i=e.target.id,o=this.root._videos.length;o--;)this.root._videos[o].id===i?s=!0:this.root._videos[o].pause();if(!s){var r=t.createVideoContext(i,this);r.id=i,this.root.playbackRate&&r.playbackRate(this.root.playbackRate),this.root._videos.push(r)}}},imgTap:function(e){var s=this;if(this.opts[5]){var o=e.currentTarget.dataset.i,n=this.childs[o],c=this.root._getItem(n),h=new r.default(this.root);this.root._edit=this,this.i=o,this.root._maskTap(),this.$set(this.ctrl,"e"+o,1),this.root._mask.push((function(){return s.$set(s.ctrl,"e"+o,0)})),this.root._tooltip({top:a(e),items:c,success:function(r){if("换图"===c[r])s.root.getSrc("img",n.attrs.src||"").then((function(t){s.root._editVal(s.opts[7]+"."+o+".attrs.src",n.attrs.src,h.getUrl(t instanceof Array?t[0]:t),!0)})).catch((function(){}));else if("宽度"===c[r]){var l=n.attrs.style||"",u=l.match(/max-width:([0-9]+)%/);u=u?parseInt(u[1]):100,s.root._slider({min:0,max:100,value:u,top:a(e),changing:function(t){Math.abs(t-u)>5&&(s.changeStyle("max-width",o,t+"%",u+"%"),u=t)},change:function(t){t!==u&&(s.changeStyle("max-width",o,t+"%",u+"%"),u=t),s.root._editVal(s.opts[7]+"."+o+".attrs.style",l,s.childs[o].attrs.style)}})}else"超链接"===c[r]?s.root.getSrc("link",n.a?n.a.href:"").then((function(t){if(n.a)s.root._editVal(s.opts[7]+"."+o+".a.href",n.a.href,h.getUrl(t),!0);else{var e={name:"a",attrs:{href:h.getUrl(t)},children:[n]};n.a=e.attrs,s.root._editVal(s.opts[7]+"."+o,n,e,!0)}i.showToast({title:"成功"})})).catch((function(){})):"预览图"===c[r]?s.root.getSrc("img",n.attrs["original-src"]||"").then((function(e){s.root._editVal(s.opts[7]+"."+o+".attrs.original-src",n.attrs["original-src"],h.getUrl(e instanceof Array?e[0]:e),!0),t.showToast({title:"成功"})})).catch((function(){})):"删除"===c[r]?s.remove(o):(s.root._setData(s.opts[7]+"."+o+".attrs.ignore",!n.attrs.ignore),t.showToast({title:"成功"}))}}),this.root._lock=!0,setTimeout((function(){s.root._lock=!1}),50)}else{var l=this.childs[e.currentTarget.dataset.i];if(l.a)return void this.linkTap(l.a);if(l.attrs.ignore)return;this.root.$emit("imgtap",l.attrs),this.root.previewImg&&t.previewImage({showmenu:this.root.showImgMenu,current:parseInt(l.attrs.i),urls:this.root.imgList})}},imgLongTap:function(t){},imgLoad:function(e){var s=this;this.opts[5]&&this.$nextTick((function(){var e=s.childs[i].attrs.id||"n"+i;t.createSelectorQuery().in(s).select("#"+e).boundingClientRect().exec((function(t){s.$set(s.ctrl,"h"+i,t[0].height)}))}));var i=e.currentTarget.dataset.i;if(this.childs[i].w)(this.opts[1]&&!this.ctrl[i]||-1===this.ctrl[i])&&this.$set(this.ctrl,i,1);else if(this.$set(this.ctrl,i,e.detail.width),this.opts[5]){var o=this.opts[7]+"."+i+".attrs.";e.detail.width<150&&this.root._setData(o+"ignore","T"),this.root._setData(o+"width",e.detail.width.toString())}this.checkReady()},checkReady:function(){var t=this;this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout((function(){t.root.getRect().then((function(e){t.root.$emit("ready",e)})).catch((function(){t.root.$emit("ready",{})}))}),350))},linkTap:function(e){var s=this;if(this.opts[5]){var i=e.currentTarget.dataset.i,o=this.childs[i],r=this.root._getItem(o);this.root._tooltip({top:a(e),items:r,success:function(e){"更换链接"===r[e]?s.root.getSrc("link",o.attrs.href).then((function(e){s.root._editVal(s.opts[7]+"."+i+".attrs.href",o.attrs.href,e,!0),t.showToast({title:"成功"})})).catch((function(){})):s.remove(i)}})}else{var n=e.currentTarget?this.childs[e.currentTarget.dataset.i]:{},c=n.attrs||e,h=c.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(n.children||[])},c)),h&&("#"===h[0]?this.root.navigateTo(h.substring(1)).catch((function(){})):h.split("?")[0].includes("://")?this.root.copyLink&&t.setClipboardData({data:h,success:function(){return t.showToast({title:"链接已复制"})}}):t.navigateTo({url:h,fail:function(){t.switchTab({url:h,fail:function(){}})}}))}},mediaError:function(t){var e=t.currentTarget.dataset.i,s=this.childs[e];if("video"===s.name||"audio"===s.name){var i=(this.ctrl[e]||0)+1;if(i>s.src.length&&(i=0),i<s.src.length)return void this.$set(this.ctrl,e,i)}else"img"===s.name&&(this.opts[2]&&this.$set(this.ctrl,e,-1),this.checkReady());this.root&&this.root.$emit("error",{source:s.name,attrs:s.attrs,errMsg:t.detail.errMsg})}}};e.default=n}).call(this,s("543d")["default"],s("bc2e")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'wxcomponents/mp-html/node/node-create-component',
    {
        'wxcomponents/mp-html/node/node-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("5f25"))
        })
    },
    [['wxcomponents/mp-html/node/node-create-component']]
]);
